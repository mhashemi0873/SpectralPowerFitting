function [] = CheckStability(data_name, Estimated_params)

load (data_name)

param_1=Estimated_params(1);
tau=Estimated_params(2);
beta_e=Estimated_params(3);
beta_i=Estimated_params(4);
G1=Estimated_params(5);
G2=Estimated_params(6);
G3=Estimated_params(7);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

G_ese=G1;
G_srs=G2;
G_esre=G3;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
a3=1/((beta_e^2)*beta_i);
a2=((2/(beta_e*beta_i))+(1/(beta_e^2)));
a1=((2+G2)/beta_e)+(1/beta_i);
a0=(1+G2);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

b2=0;
b1=-(G1/beta_i);
b0=(G3-G1);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

z3=1;
z2=((a2^2)-(2*a1*a3))/(a3^2);
z1=((a1^2)-(2*a0*a2)-(b1^2))/(a3^2);
z0=((a0^2)-(b0^2))/(a3^2);

delta=-4*z1^3+(z1^2*z2^2)+18*z2*z1*z0-(4*z0*(z2^3))-(27*z0^2);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
C1=-(beta_e-beta_i);
C2=-(a1+b1); 
C3=-(a0+b0);
C4=-(((a2+b2)*(a1+b1))-(a3*(a0+b0)));
C5=-z0;
C6=delta;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 %C1=beta-alpha; 
 %C2=(alpha*(G_ese-1))-(beta*(G_srs+2)) ;
 %C3=G_ese-G_srs-G_esre-1; 
 %C4=-C3-((2*alpha+beta)*(((G_srs+2)/alpha)+((1-G_ese)/beta))); 
 %C5=((alpha^2*beta)^2)*(((G_esre-G_ese)^2)-((G_srs+1)^2));
 
% C(6)=-((1/alpha)*((1/alpha)+(2/beta)))-(4*(tau^2)*(G_esre-G_ese))-(4*G_ese*tau/beta);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

if C1<0 & C2<0 & C3<0 & C4<0 & C5<0 & C6<0
    
    fprintf('\n   <<The Stability Conditions are Satisfied>>')
    
else
     
    fprintf('\n   <<The Stability Conditions are NOT Satisfied>>')
end
       
  fprintf('\n ')
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
j=1;
df=Xdata(2)-Xdata(1);fn=Xdata(end);

for w=0.:df:fn;
    
 w=2*pi.*w;

  
 Le=(1i*(1./beta_e)*w)+1;
 Li=(1i*(1./beta_i)*w)+1;
 
 Nom=-param_1*exp(-1i*tau*w)*Li;
 Dom=(Le*((Le*Li)+G_srs))+(exp(-2*1i*tau*w)*(G_esre-(G_ese*Li)));


G_12=Nom/Dom;

Power(j)=abs(G_12).^2;

j=j+1;

end


R=corrcoef(Ydata,log(Power))
end

